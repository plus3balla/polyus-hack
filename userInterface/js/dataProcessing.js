/*const data = [[750.8038940429688, 334.7147216796875, 815.0478515625, 395.926025390625], 
[765.270751953125, 313.1631774902344, 828.9168090820312, 371.4296875], 
[238.82237243652344, 338.8613586425781, 269.0549621582031, 368.3356018066406], 
[64.5764389038086, 96.21405029296875, 301.75933837890625, 347.772705078125], 
[261.1761169433594, 369.9085693359375, 291.62799072265625, 398.3536682128906], 
[771.4579467773438, 329.9000244140625, 837.5923461914062, 388.16070556640625], 
[287.9586486816406, 362.7450256347656, 318.6083679199219, 392.4746398925781], 
[170.70484924316406, 311.02734375, 345.86029052734375, 391.5426025390625], 
[989.999755859375, 634.168212890625, 1052.5550537109375, 696.9129028320312], 
[967.7447509765625, 656.399169921875, 1027.619140625, 717.3877563476562], 
[40.595272064208984, 385.2674865722656, 69.68623352050781, 416.516357421875], 
[120.64205932617188, 72.49903106689453, 183.9453125, 132.25111389160156], 
[946.938232421875, 661.7015380859375, 967.2138061523438, 703.1275634765625], 
[258.88671875, 372.4028625488281, 327.831298828125, 434.666259765625], 
[259.22845458984375, 344.0328674316406, 327.380126953125, 407.28924560546875], 
[257.305419921875, 381.68585205078125, 287.6098327636719, 410.7052307128906], 
[239.4930877685547, 328.0423583984375, 269.0313415527344, 356.58563232421875], 
[983.0901489257812, 609.515625, 1042.2073974609375, 673.3718872070312], 
[581.0145874023438, 275.2880554199219, 824.1834106445312, 520.3604125976562], 
[814.6460571289062, 316.16815185546875, 878.905029296875, 375.1028747558594], 
[232.07476806640625, 327.92254638671875, 294.98773193359375, 389.1299743652344], 
[169.98951721191406, 259.0841064453125, 200.66160583496094, 289.3707580566406], 
[264.9683532714844, 361.6897277832031, 295.49700927734375, 391.1330871582031], 
[737.0060424804688, 318.58453369140625, 800.554443359375, 381.0845642089844], 
[228.1234130859375, 376.54315185546875, 294.8210754394531, 438.8114318847656], 
[759.6104736328125, 353.462646484375, 823.2557983398438, 417.58489990234375], 
[208.80213928222656, 343.15802001953125, 270.7326965332031, 403.3997497558594], 
[230.7449188232422, 350.9789733886719, 261.7280578613281, 380.08203125], 
[124.9473876953125, 199.00570678710938, 183.3828887939453, 263.979248046875], 
[799.4326171875, 492.4933166503906, 860.3442993164062, 554.3929443359375], 
[229.84573364257812, 331.9739074707031, 260.39483642578125, 362.10076904296875], 
[0.0, 380.7030029296875, 189.1222381591797, 645.372314453125], 
[36.961097717285156, 369.99566650390625, 65.91979217529297, 399.4913635253906], 
[233.5516357421875, 395.6600036621094, 303.6023864746094, 458.9755859375], 
[194.5240936279297, 288.64178466796875, 256.1505126953125, 348.6537170410156], 
[171.0384521484375, 225.7877197265625, 230.123291015625, 289.2409362792969], 
[1099.070068359375, 120.37665557861328, 1120.1407470703125, 164.2860565185547], 
[879.3329467773438, 396.41552734375, 1278.3018798828125, 718.770751953125], 
[1003.7754516601562, 244.14340209960938, 1066.1568603515625, 302.52008056640625], 
[170.80836486816406, 196.6582794189453, 231.85882568359375, 257.9277038574219], 
[1074.276611328125, 117.74175262451172, 1139.087890625, 179.03526306152344], 
[811.6511840820312, 266.6343994140625, 875.6170043945312, 327.05487060546875], 
[953.9946899414062, 667.2166748046875, 974.3675537109375, 707.2880249023438], 
[709.9097290039062, 146.7018280029297, 740.7096557617188, 174.73883056640625], 
[743.2800903320312, 88.9997787475586, 803.4859008789062, 147.2024383544922], 
[147.11495971679688, 216.5354766845703, 205.6671600341797, 279.127685546875], 
[265.75213623046875, 385.0063781738281, 295.8053894042969, 414.038330078125], 
[864.1453247070312, 312.22137451171875, 926.635498046875, 372.2333068847656], 
[572.3130493164062, 64.34272766113281, 821.4810180664062, 308.82208251953125], 
[1088.875732421875, 119.59976196289062, 1120.6480712890625, 148.6279296875], 
[854.4935302734375, 325.50091552734375, 918.2222900390625, 386.70465087890625], 
[1128.8712158203125, 121.86595916748047, 1150.626220703125, 164.37728881835938], 
[273.4895324707031, 71.23043823242188, 523.8504638671875, 301.3397521972656], 
[846.8687744140625, 295.3136901855469, 913.27294921875, 356.2947692871094], 
[1105.304443359375, 39.01716232299805, 1168.0166015625, 101.94571685791016], 
[1071.159423828125, 268.82379150390625, 1160.5028076171875, 439.9013366699219], 
[1106.74951171875, 121.07324981689453, 1127.8714599609375, 165.1178741455078], 
[965.8419799804688, 662.8401489257812, 986.5157470703125, 703.4100341796875], 
[942.627685546875, 654.172119140625, 962.9567260742188, 696.9141845703125], 
[744.2894287109375, 111.28905487060547, 805.3267822265625, 171.7569580078125], 
[200.36029052734375, 263.27227783203125, 263.58465576171875, 323.64447021484375], 
[970.8640747070312, 627.41650390625, 1031.3634033203125, 687.4764404296875], 
[145.34420776367188, 255.48968505859375, 206.64361572265625, 316.81182861328125], 
[153.75369262695312, 239.73121643066406, 213.8691864013672, 302.1970520019531], 
[178.5227813720703, 296.2471618652344, 240.0765380859375, 353.4233093261719], 
[977.2399291992188, 0.7968094944953918, 1227.9150390625, 203.08087158203125], 
[1226.294921875, 378.44207763671875, 1258.3861083984375, 407.8162536621094], 
[825.6300659179688, 256.631591796875, 890.9926147460938, 317.7074890136719], 
[300.8090515136719, 257.2064208984375, 331.7200012207031, 284.6308288574219], 
[139.44801330566406, 496.1656494140625, 199.99014282226562, 559.292236328125], 
[226.85702514648438, 307.0410461425781, 286.8995056152344, 366.3626708984375], 
[968.1409301757812, 595.3408203125, 1027.8758544921875, 658.94580078125], 
[42.635108947753906, 248.24537658691406, 301.0833740234375, 507.24456787109375], 
[478.10113525390625, 193.8921661376953, 539.2559814453125, 254.00161743164062], 
[958.247314453125, 228.74545288085938, 989.51318359375, 259.90631103515625], 
[28.811674118041992, 373.9244384765625, 57.72803497314453, 403.37713623046875], 
[817.9610595703125, 475.2947692871094, 879.44091796875, 536.404052734375], 
[1085.1680908203125, 140.2572021484375, 1116.6654052734375, 168.98843383789062], 
[163.10055541992188, 264.7583923339844, 223.89625549316406, 324.7692565917969], 
[965.4100952148438, 677.2368774414062, 985.9730224609375, 719.3255615234375], 
[781.94189453125, 283.2118225097656, 844.606201171875, 343.8213195800781], 
[250.4824676513672, 327.53387451171875, 280.7503662109375, 356.5292053222656], 
[269.1817321777344, 403.4486389160156, 334.399658203125, 465.33636474609375], 
[155.45286560058594, 303.03887939453125, 218.16136169433594, 361.56048583984375], 
[790.1216430664062, 340.4468078613281, 854.4246215820312, 403.27294921875], 
[1238.16552734375, 373.26202392578125, 1269.6181640625, 402.9671630859375], 
[510.1821594238281, 201.96383666992188, 568.6114501953125, 260.8800964355469], 
[1111.5450439453125, 45.85807800292969, 1141.22900390625, 74.50237274169922], 
[750.9577026367188, 65.71565246582031, 809.6246337890625, 123.5873794555664], 
[744.414794921875, 361.8791198730469, 807.8151245117188, 426.4275207519531], 
[120.21896362304688, 196.18406677246094, 162.6099853515625, 218.73837280273438], 
[839.7998657226562, 266.92156982421875, 869.5985717773438, 296.71630859375], 
[257.45977783203125, 321.42938232421875, 321.72265625, 384.5373840332031], 
[293.694091796875, 210.5929412841797, 323.7876892089844, 238.54286193847656], 
[123.59162902832031, 533.4620361328125, 144.3114776611328, 573.0587768554688], 
[29.512235641479492, 358.48297119140625, 58.35102844238281, 387.68096923828125], 
[735.8138427734375, 57.28715133666992, 795.4635009765625, 117.75260162353516], 
[1234.7464599609375, 390.8495788574219, 1279.508056640625, 453.00848388671875], 
[720.2418823242188, 169.44326782226562, 978.560546875, 407.33355712890625], 
[640.1200561523438, 432.5050048828125, 700.2384033203125, 493.0884094238281]];
*/
const pic = newData['frame'];

document.getElementById('base64image').src = `data:image/jpeg;base64,${pic}`;

const getClassesPercent = (data) => {
    const n_data = data.length;
    let classes = [0, 0, 0, 0, 0, 0, 0];

    for (let i = 0; i < n_data; ++i) {
        let [x1, y1, x2, y2] = data[i];
        const a = 2.9768213048 * Math.max(x2 - x1, y2 - y1);
        if (a <= 40) {
            classes[0]++;
        } else if (a <= 70) {
            classes[1]++;
        } else if (a <= 80) {
            classes[2]++;
        } else if (a <= 100) {
            classes[3]++;
        } else if (a <= 150) {
            classes[4]++;
        } else if (a <= 250) {
            classes[5]++;
        } else {
            classes[6]++;
        }
    }

    // get percents for each class
    for (let i = 0; i < 7; ++i) {
        classes[i] = classes[i] * 100 / n_data;
    }
    return classes;
}

const getMaxValue = (data) => {

    const n_data = data.length;
    let maxStone = 0;

    for (let i = 0; i < n_data; ++i) {
        let [x1, y1, x2, y2] = data[i];
        const a = Math.max(x2 - x1, y2 - y1);
        if (a > maxStone) maxStone = a;
    }
    return maxStone;
}

const drawRects = (data) => {

    const n_data = data.length;

    for (let i = 0; i < n_data; ++i) {
        let [x1, y1, x2, y2] = data[i];
        const a = 2.9768213048 * Math.max(x2 - x1, y2 - y1);
        let color;
        if (a <= 40) {
            color = "#6D2EB2";
        } else if (a <= 70) {
            color = "#00EAFF";
        } else if (a <= 80) {
            color = "#2EB28C";
        } else if (a <= 100) {
            color = "#42B22E";
        } else if (a <= 150) {
            color = "#8CB22E";
        } else if (a <= 250) {
            color = "#E45436";
        } else {
            color = "#FF9900";
        }
        [x1, y1, x2, y2] = [x1 * 0.239583, y1 * 0.231481, x2 * 0.239583, y2 * 0.231481];
        //[x1, y1, x2, y2] = [x1 * 0.359375, y1 * 0.347222, x2 * 0.359375, y2 * 0.347222];
        document.getElementById("rects").insertAdjacentHTML('beforeend', `<polygon points="${x1},${y1} ${x1},${y2} ${x2},${y2} ${x2},${y1} ${x1},${y1}" fill="none" stroke="${color}" />`);
    }
}